<!DOCTYPE html>
<html>
<head><title>K8s Namespaces</title>
<meta charset="utf-8">
<!-- <link rel="shortcut icon" type="image/png" href="pict/favicon.png"/> -->
<link rel="stylesheet" type="text/css" href="styles.css"/>
<link rel="stylesheet" type="text/css" href="layout.css"/>

</head>
<body>

<div class="header"><i>This is an automatically generated document.</i></div>
<div class="sidebar">
    <table class="sidebarAligner">
        <tr><td valign="top">
            
            <h3>Sections</h3>
            <p><a href="about.html">About the course</a></p>
            <p><a href="index.html">Theory</a></p>
            <p><a href="installation.html">Working environment installation</a></p>
            <p><a href="kubectl_commands.html">Main Kubectl commands</a></p>
            <p><a href="yaml_config_file.html">K8s YAML Configuration file</a></p>
            <p><a href="demo_project.html">Complete demo project</a></p>
            <p><a href="namespaces.html">K8s Namespaces</a></p>
            
            <h3>Side steps</h3>
            <p><a href="external_access.html">Access external Services from outside the Minicube cluster</a></p>
            
        </td></tr>
        <tr><td class="bottom" valign="bottom">
            <i>Generated by md2html_py 0.1.2
            <br />2021-07-07 20:37:09</i>
        </td></tr>
    </table>
</div>

<p>[<a href="demo_project.html">BACK</a>]</p>
<hr />
<p><p style="font-size: 40px; font-weight: bold;">K8s Namespaces</p></p>
<div class="toc">
<ul>
<li><a href="#what-is-a-namespace">What is a Namespace?</a></li>
<li><a href="#default-namespaces">Default Namespaces</a></li>
<li><a href="#create-a-namespace">Create a Namespace</a></li>
<li><a href="#why-to-use-namespaces">Why to use Namespaces?</a><ul>
<li><a href="#namespaces-group-components">Namespaces group components</a></li>
<li><a href="#name-scopes-for-multiple-teams">Name scopes for multiple teams</a></li>
<li><a href="#resource-sharing">Resource sharing</a></li>
<li><a href="#resource-limits">Resource limits</a></li>
</ul>
</li>
<li><a href="#characteristics-of-namespaces">Characteristics of Namespaces</a></li>
<li><a href="#create-components-in-namespaces">Create components in Namespaces</a></li>
</ul>
</div>
<hr />
<h1 id="what-is-a-namespace">What is a Namespace?</h1>
<p><a href="https://youtu.be/X48VuDVv0do?t=6374">1:46:14</a></p>
<p>A <strong>Namespace</strong> may be thought as a virtual cluster inside a cluster.</p>
<hr />
<h1 id="default-namespaces">Default Namespaces</h1>
<pre class="highlight"><code class="language-shell">$ kubectl get namespaces
NAME                   STATUS   AGE
default                Active   3d17h
kube-node-lease        Active   3d17h
kube-public            Active   3d17h
kube-system            Active   3d17h
kubernetes-dashboard   Active   3d17h</code></pre>

<p><code>kubernetes-dashboard</code> namespace is specific to minikube installation. It's not present in a real
K8s cluster.</p>
<p><code>kube-system</code> is not for user's components and must not be modified by the users. It contains 
system processes, Master and Kubectl processes, etc.</p>
<p><code>kube-public</code> is for publicly accessible data like ConfigMap that contains cluster information
and is accessible even without authentication:</p>
<pre class="highlight"><code class="language-shell">$ kubectl cluster-info
Kubernetes control plane is running at https://192.168.49.2:8443
KubeDNS is running at https://192.168.49.2:8443/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy</code></pre>

<p><code>kube-node-lease</code> is present in the recent edition of K8s. Contains heartbeats of the Nodes. Each
Node has associated lease object in this Namespace, that determines the availability of the Node.</p>
<p><code>default</code> Namespace contains all created user's components if the other Namespaces are not created.</p>
<hr />
<h1 id="create-a-namespace">Create a Namespace</h1>
<pre class="highlight"><code class="language-shell">$ kubectl create namespace my-namespace
namespace/my-namespace created

$ kubectl get namespaces
NAME                   STATUS   AGE
.  .  .
my-namespace           Active   3s</code></pre>

<p>But it's probably better to create a Namespace using configuration files:</p>
<pre class="highlight"><code class="language-code">apiVersion: v1
kind: ConfigMap
metadata:
  name: mysql-configmap
  namespace: my-namespace
data:
  db_url: mysql-service.database</code></pre>

<hr />
<h1 id="why-to-use-namespaces">Why to use Namespaces?</h1>
<p><a href="https://youtu.be/X48VuDVv0do?t=6552">1:49:12</a></p>
<p>Also see K8s documentation, section
<a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces/">Namespaces</a>.</p>
<h2 id="namespaces-group-components">Namespaces group components</h2>
<p><img alt="" src="pict/namespaces_group_conponents_01.png" /></p>
<p>With one Namespace it's difficult to overview the architecture.</p>
<p><img alt="" src="pict/namespaces_group_conponents_02.png" /></p>
<p>According to the official
<a href="https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces/">K8s documentation</a>
using Namespaces should not be considered for smaller projects with fewer users. Though even in 
smaller projects there may be common resources like logging and monitoring systems, and Namespaces
help to separate them for better overview.</p>
<h2 id="name-scopes-for-multiple-teams">Name scopes for multiple teams</h2>
<p><img alt="" src="pict/namespaces_name_scopes_01.png" /></p>
<p>If two teams develop different applications with (somehow) the same name then Namespaces
will prevent name conflicts and thus interference on deployment.</p>
<h2 id="resource-sharing">Resource sharing</h2>
<p><img alt="" src="pict/namespaces_share_components_01.png" /></p>
<p>We can use the same resources for the different development state deployments. I.e. we don't
need to include the common resources (such as databases) into each deployment. Such architecture
may be used in <a href="https://en.wikipedia.org/wiki/Blue-green_deployment">Blue-green deployment</a> when
there are two servers  and only one of them accepts external requests. The other is accessible 
only inside the company's internal network and is used for testing the changes. Then, when the 
changes are tested, the servers swap their roles.</p>
<h2 id="resource-limits">Resource limits</h2>
<p><img alt="" src="pict/namespaces_resource_restriction_01.png" /></p>
<p>Two teams may be prevented from interfering each other's projects. Also resource restrictions
(like CPU, RAM, storage, etc.) may be defined for a Namespace.</p>
<hr />
<h1 id="characteristics-of-namespaces">Characteristics of Namespaces</h1>
<p><a href="https://youtu.be/X48VuDVv0do?t=6907">1:55:07</a></p>
<p>Most components cannot be accessed across the Namespaces.</p>
<p><img alt="" src="pict/configmap_across_namespaces.png" /></p>
<p>Particularly, such components are ConfigMaps and Secrets. We need to create them for each
Namespace if required.</p>
<p>But Services <strong>can</strong> be shared across Namespaces. The references are done using the dot notation:</p>
<pre class="highlight"><code class="language-code">apiVersion: v1
kind: ConfigMap
.  .  .
data:
  db_url: mysql-service.database</code></pre>

<p>Here <code>mysql-service</code> is the Namespace and <code>database</code> is the Service.</p>
<p>Some components <strong>cannot</strong> be created within a Namespace, they must belong globally to the cluster 
only. Such components are Volumes and Nodes.</p>
<pre class="highlight"><code class="language-shell">$ kubectl api-resources --namespaced=true
NAME                        SHORTNAMES   APIVERSION         NAMESPACED   KIND
.  .  .                                                
configmaps                  cm           v1                 true         ConfigMap
pods                        po           v1                 true         Pod
secrets                                  v1                 true         Secret
services                    svc          v1                 true         Service
deployments                 deploy       apps/v1            true         Deployment
replicasets                 rs           apps/v1            true         ReplicaSet
statefulsets                sts          apps/v1            true         StatefulSet
.  .  .

$ kubectl api-resources --namespaced=false
NAME              SHORTNAMES   APIVERSION                   NAMESPACED   KIND
.  .  .                                           
namespaces        ns           v1                           false        Namespace
nodes             no           v1                           false        Node
.  .  .</code></pre>

<hr />
<h1 id="create-components-in-namespaces">Create components in Namespaces</h1>
<p><a href="https://youtu.be/X48VuDVv0do?t=7060">1:57:40</a></p>
<hr />
<p>[<a href="demo_project.html">BACK</a>]</p>
<hr />
<hr />
<hr />
<hr />
<hr />

</body>
</html>

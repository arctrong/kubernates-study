<!DOCTYPE html>
<html>
<head><title>Working environment installation</title>
<meta charset="utf-8">
<link rel="shortcut icon" type="image/png" href="pict/favicon.png"/>
<link rel="stylesheet" type="text/css" href="layout/styles.css"/>
<link rel="stylesheet" type="text/css" href="layout/layout.css"/>

<style>
.headerNavArrows {position: relative; top: 3px;}
</style>
</head>
<body>

<div class="header"><b style="margin-right:7px;"><span styles="">K8s</span></b><a class="header_item" href="about.html">About</a><a class="header_item" href="index_page.html">Index</a>

<a href="index.html" title="Previous: Theory"><img class="headerNavArrows" src="pict/previous_page_h18px.png"/></a>

<a href="kubectl_commands.html" title="Next: Main Kubectl commands"><img class="headerNavArrows" src="pict/next_page_h18px.png"/></a>


<span class="headerTitle">Working environment installation</span>
</div>

<div class="sidebar">
    <table class="sidebarAligner">
        <tr><td valign="top">
            <div class="sidebar_item "><a href="about.html">About the course</a></div><div class="sidebar_item "><a href="index.html">Theory</a></div><div class="sidebar_item selected"><a href="installation.html">Working environment installation</a></div><div class="sidebar_item "><a href="kubectl_commands.html">Main Kubectl commands</a></div><div class="sidebar_item "><a href="yaml_config_file.html">YAML Configuration file</a></div><div class="sidebar_item "><a href="demo_project.html">Complete demo project</a></div><div class="sidebar_item "><a href="namespaces.html">Namespaces</a></div><div class="sidebar_item "><a href="ingress.html">Ingresses</a></div><div class="sidebar_item "><a href="helm.html">Helm Package Manager</a></div><div class="sidebar_item "><a href="volumes.html">Persisting Data with Volumes</a></div><div class="sidebar_item "><a href="stateful_sets.html">StatefulSets</a></div><div class="sidebar_item "><a href="services.html">Services</a></div>
            <h3>Side steps</h3>
            <div class="sidebar_item "><a href="external_access.html">Access external Services from outside the Minicube cluster</a></div>
        </td></tr>
        <tr><td class="bottom" valign="bottom">
            Generated by <a href="https://github.com/arctrong/md2html">md2html_py</a> 1.0.2
        </td></tr>
    </table>
</div>

<p style="font-size:44px;font-weight:bold;margin:0 0 30px 0;">Working environment installation</p>

<!--METADATA {"title": "Working environment installation"} -->

<div class="toc">
<ul>
<li><a href="#minikube-and-kubectl">Minikube and Kubectl</a></li>
<li><a href="#minikube-installation">Minikube installation</a><ul>
<li><a href="#installation">Installation</a></li>
<li><a href="#checking-and-testing">Checking and testing</a></li>
<li><a href="#first-start">First start</a></li>
</ul>
</li>
<li><a href="#kubectl-installation">kubectl installation</a><ul>
<li><a href="#installation_1">Installation</a></li>
<li><a href="#checking-and-testing_1">Checking and testing</a></li>
</ul>
</li>
<li><a href="#trying-minikube-dashboard">Trying Minikube Dashboard</a></li>
</ul>
</div>
<hr />
<p><a name="index_entry_index_1"></a></p>
<h1 id="minikube-and-kubectl">Minikube and Kubectl</h1>
<p><a href="https://www.youtube.com/watch?v=X48VuDVv0do&amp;t=2087s">34:47</a></p>
<p>In the production environment:</p>
<ul>
<li>multiple Master and Worker Nodes are used;</li>
<li>each Node is a separate physical or virtual machine.</li>
</ul>
<p>For a personal testing on a local machine such setup may be too difficult or impossible.
So <a href="https://minikube.sigs.k8s.io/docs/"><strong>Minicube</strong></a>, open source solution, may be used that
runs Master and Worker processes on one machine and has Docker runtime container preinstalled.</p>
<p><a href="https://kubernetes.io/docs/reference/kubectl/overview/"><strong>Kubectl</strong></a> is a command line tool for
K8s cluster. There are also web interface and REST API, but Kubectl is the most powerful.
It communicates with the Master Node API Server to fulfill tasks like creating and destroying
pods, creating services, etc.</p>
<blockquote>
<p>We will use <code>kubectl</code> to work with the Minikube cluster. But Kubectl may be used for
managing real K8s clusters as well.</p>
</blockquote>
<hr />
<p><em>Jul 2, 2021</em></p>
<h1 id="minikube-installation">Minikube installation</h1>
<p><a href="https://youtu.be/X48VuDVv0do?t=2338">38:58</a> Here we are not going to follow the instructions in 
the video.</p>
<p>Minikube <a href="https://minikube.sigs.k8s.io/docs/">home page</a>.  <br />
Minikube <a href="https://minikube.sigs.k8s.io/docs/start/">installation instructions</a>.</p>
<blockquote>
<p><strong>Note.</strong> In non-Linux environments a virtualization system (like VirtualBox) is required. Here
we don't need it since we are working in a real Ubuntu Linux.</p>
</blockquote>
<h2 id="installation">Installation</h2>
<p>The environment:</p>
<pre class="highlight"><code class="language-shell">$ uname -a
Linux myhost 5.4.0-70-generic #78~18.04.1-Ubuntu SMP Sat Mar 20 14:10:07 UTC 2021 x86_64 x86_64 x86_64 GNU/Linux</code></pre>
<p>Using the Linux distributive independent method.</p>
<blockquote>
<p><strong>Note.</strong> With distributive specific installation (Debian package in this case), <code>kubectl</code> tool
must probably be installed automatically. But now we are going to later install it separately.</p>
</blockquote>
<pre class="highlight"><code class="language-shell">$ curl -LO https://storage.googleapis.com/minikube/releases/latest/minikube-linux-amd64

$ du -h minikube-linux-amd64
62M     minikube-linux-amd64

$ sudo install minikube-linux-amd64 /usr/local/bin/minikube</code></pre>
<h2 id="checking-and-testing">Checking and testing</h2>
<pre class="highlight"><code class="language-shell">$ which minikube
/usr/local/bin/minikube

$ minikube version
minikube version: v1.21.0
commit: 76d74191d82c47883dc7e1319ef7cebd3e00ee11</code></pre>
<h2 id="first-start">First start</h2>
<blockquote>
<p>In non-Linux environment <code>--vm-driver</code> parameter must be used.</p>
</blockquote>
<pre class="highlight"><code class="language-shell">$ minikube start
* minikube v1.21.0 on Ubuntu 18.04
* Automatically selected the docker driver. Other choices: none, ssh
* Starting control plane node minikube in cluster minikube
* Pulling base image ...
* Downloading Kubernetes v1.20.7 preload ...
    &gt; preloaded-images-k8s-v11-v1...: 492.20 MiB / 492.20 MiB  100.00% 6.05 MiB
    &gt; gcr.io/k8s-minikube/kicbase...: 359.09 MiB / 359.09 MiB  100.00% 3.97 MiB
* Creating docker container (CPUs=2, Memory=2200MB) ...
* Preparing Kubernetes v1.20.7 on Docker 20.10.7 ...
  - Generating certificates and keys ...
  - Booting up control plane ...
  - Configuring RBAC rules ...
* Verifying Kubernetes components...
  - Using image gcr.io/k8s-minikube/storage-provisioner:v5
* Enabled addons: storage-provisioner, default-storageclass
* kubectl not found. If you need it, try: 'minikube kubectl -- get pods -A'
* Done! kubectl is now configured to use "minikube" cluster and "default" namespace by default</code></pre>
<blockquote>
<p>The existing Docker version is:</p>
<pre class="highlight"><code class="language-shell">$ docker --version
Docker version 20.10.5, build 55c4c88</code></pre>
<p>So looks like <code>minikube</code> uses its own Docker container runtime.</p>
</blockquote>
<pre class="highlight"><code class="language-shell">$ kubectl get po -A
-bash: kubectl: command not found</code></pre>
<p><code>kubectl</code> will be installed later. Now need to use the less convenient syntax:</p>
<pre class="highlight"><code class="language-shell">$ minikube kubectl -- get po -A
    &gt; kubectl.sha256: 64 B / 64 B [--------------------------] 100.00% ? p/s 0s
    &gt; kubectl: 38.36 MiB / 38.36 MiB [-------------] 100.00% 10.81 MiB p/s 3.8s
NAMESPACE     NAME                               READY   STATUS    RESTARTS   AGE
kube-system   coredns-74ff55c5b-bp46q            1/1     Running   0          6m23s
kube-system   etcd-minikube                      1/1     Running   0          6m29s
kube-system   kube-apiserver-minikube            1/1     Running   0          6m29s
kube-system   kube-controller-manager-minikube   1/1     Running   0          6m29s
kube-system   kube-proxy-h6r7v                   1/1     Running   0          6m23s
kube-system   kube-scheduler-minikube            1/1     Running   0          6m29s
kube-system   storage-provisioner                1/1     Running   0          6m34s</code></pre>
<p>That's probably it. The cluster may be used.</p>
<blockquote>
<p>We need the cluster running for the following steps. The command to stop it is <code>minikube stop</code>.</p>
</blockquote>
<hr />
<h1 id="kubectl-installation"><code>kubectl</code> installation</h1>
<p>K8s doc: <a href="https://kubernetes.io/docs/reference/kubectl/overview/"><code>kubectl</code> overview</a> |
<a href="https://kubernetes.io/docs/tasks/tools/install-kubectl-linux/">Install and Set Up kubectl on Linux</a>.</p>
<h2 id="installation_1">Installation</h2>
<p>Using the Linux distributive independent method:</p>
<pre class="highlight"><code class="language-shell">$ curl -L -s https://dl.k8s.io/release/stable.txt &amp;&amp; echo
v1.21.2</code></pre>
<p>In the following commands insert the version (<code>v1.21.2</code> in this case) instead of <code>&lt;version&gt;</code>.</p>
<pre class="highlight"><code class="language-shell">$ curl -LO "https://dl.k8s.io/release/&lt;version&gt;/bin/linux/amd64/kubectl"

$ curl -LO "https://dl.k8s.io/&lt;version&gt;/bin/linux/amd64/kubectl.sha256"

$ echo "$(&lt;kubectl.sha256) kubectl" | sha256sum --check
kubectl: OK

$ sudo install -o root -g root -m 0755 kubectl /usr/local/bin/kubectl</code></pre>
<h2 id="checking-and-testing_1">Checking and testing</h2>
<pre class="highlight"><code class="language-shell">$ which kubectl
/usr/local/bin/kubectl

$ kubectl version --short=true
Client Version: v1.21.2
Server Version: v1.20.7</code></pre>
<hr />
<h1 id="trying-minikube-dashboard">Trying Minikube Dashboard</h1>
<p>See <a href="https://kubernetes.io/docs/tasks/access-application-cluster/web-ui-dashboard/">K8s Dashboard</a>.</p>
<blockquote>
<p><strong>Notes:</strong> <strong>1.</strong> The Dashboard may be a convenient administration tool but we are going to
primarily use command line in the course.</p>
<p><strong>2.</strong> This Dashboard is not installed in a real K8s cluster by default.</p>
</blockquote>
<pre class="highlight"><code class="language-shell">$ minikube dashboard
.  .  .
* Opening http://127.0.0.1:46867/api/v1/namespaces/kubernetes-dashboard/services/http:kubernetes-dashboard:/proxy/ in your default browser...
.  .  .
Error: cannot open display: localhost:10.0</code></pre>
<p>This works if executed on the Ubuntu host directly. The link is automatically opened in the 
browser:</p>
<p><a name="minikube_dashboard_picture"></a></p>
<p><img alt="" src="pict/minikube_dashboard.png" /></p>
<p>External access may be adjusted using the instructions: 
<a href="external_access.html#using_k8s_proxy">this</a> or <a href="ingress.html#create_ingress_rule">this</a> (the
latter is probably better).</p>
<p>&nbsp;</p>
<hr />

<p style="margin-top:0px;margin-bottom:0px;text-align:right;"><a href="index.html" 
title="Previous: Theory"><img src="pict/previous_page.png"/></a>

<a href="kubectl_commands.html" title="Next: Main Kubectl commands"><img 
src="pict/next_page.png"/></a>
</p>

<div style="height: 1000px;"><p>&nbsp;</p></div>

</body>
</html>
